<!DOCTYPE html>
<html lang="en"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Reading Data from Excel Sheets in Python - Mosab Ahmad</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://www.mos3abof.com:8000/reading-data-from-excel-sheets-in-python.html">

        <meta name="author" content="Mosab Ahmad" />
        <meta name="keywords" content="Python,XLRD,Excel" />
        <meta name="description" content="On May 22nd 2012 I was approached by the official campaign of the presidential candidate &#34;Abolfotoh&#34;. They needed help setting up a Google App Engine application. It was an interactive map that uses Google Maps to plot data about voters and polling stations. What they wanted further was to create ..." />

        <meta property="og:site_name" content="Mosab Ahmad" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Reading Data from Excel Sheets in Python"/>
        <meta property="og:url" content="http://www.mos3abof.com:8000/reading-data-from-excel-sheets-in-python.html"/>
        <meta property="og:description" content="On May 22nd 2012 I was approached by the official campaign of the presidential candidate &#34;Abolfotoh&#34;. They needed help setting up a Google App Engine application. It was an interactive map that uses Google Maps to plot data about voters and polling stations. What they wanted further was to create ..."/>
        <meta property="article:published_time" content="2013-02-19" />
            <meta property="article:section" content="misc" />
            <meta property="article:tag" content="Python" />
            <meta property="article:tag" content="XLRD" />
            <meta property="article:tag" content="Excel" />
            <meta property="article:author" content="Mosab Ahmad" />
            <meta property="og:image"
                  content="http://www.mos3abof.com:8000/http://www.mos3abof.com/theme/img/cigar-about-green-eye-medium.jpg"/>


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://www.mos3abof.com:8000/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://www.mos3abof.com:8000/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://www.mos3abof.com:8000/theme/css/pygments/monokai.css" rel="stylesheet">
	<!--<link rel="stylesheet" href="http://www.mos3abof.com:8000/theme/css/style.css" type="text/css"/>-->

        <link href="http://www.mos3abof.com:8000/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Mosab Ahmad ATOM Feed"/>
	
	<!-- Added by Mosab -->
	<!--<link href="http://getbootstrap.com/examples/blog/blog.css" rel="stylesheet">-->
	<link href='http://fonts.googleapis.com/css?family=Vollkorn:400,700' rel='stylesheet' type='text/css'>
	<style>body,h1,h2,h3,h4,p,div,span{font-family:'Vollkorn',serif!important}h2{font-size:1.6em}h3{font-size:1.3em}.axis{font:10px sans-serif}.axis path,.axis line{fill:none;stroke:#000;shape-rendering:crispEdges}rect.bordered{stroke:#e6e6e6;stroke-width:2px}text.mono{font-size:9pt;font-family:Consolas,courier;fill:#aaa}text.axis-workweek{fill:#000}text.axis-worktime{fill:#000}i{color:#5cb85c}</style>
	<!-- End of Added by Mosab -->
</head>
<body>


	<div class="blog-masthead">
	<div class="container">
        <nav class="blog-nav">
            <a href="http://www.mos3abof.com:8000/" class="blog-nav-item">
Mosab Ahmad                         <a class="blog-nav-item " href="http://www.mos3abof.com:8000/pages/about.html">
                             About
                          </a>
                         <a class="blog-nav-item " href="http://www.mos3abof.com:8000/pages/projects.html">
                             Projects
                          </a>
              <a href="http://www.mos3abof.com:8000/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            
		</nav>
    </div>
	</div> <!-- /.navbar -->


<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://www.mos3abof.com:8000/reading-data-from-excel-sheets-in-python.html"
                       rel="bookmark"
                       title="Permalink to Reading Data from Excel Sheets in Python">
                        Reading Data from Excel Sheets in Python
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-02-19T11:18:00+02:00"> 19 Feb, 2013</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="http://www.mos3abof.com:8000/tag/python.html">Python</a>
        /
	<a href="http://www.mos3abof.com:8000/tag/xlrd.html">XLRD</a>
        /
	<a href="http://www.mos3abof.com:8000/tag/excel.html">Excel</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>On <em>May 22nd 2012</em> I was approached by the official campaign of the
presidential candidate "<a href="http://www.abolfotoh.net/">Abolfotoh</a>".</p>
<p>They needed help setting up a Google App Engine application.</p>
<p>It was an interactive map that uses Google Maps to plot data about
voters and polling stations.</p>
<p>What they wanted further was to create another application to collect
data from their official representatives on the ground and use this tool</p>
<p>to feed the Google App Engine application with data.</p>
<p>The application was originally created by "<a href="http://www.espace.com.eg">Espace</a>" <em>-an awesome
Egyptian company-</em> and published on <a href="https://code.google.com/p/egypt-election-2012-demo/">Google Code</a>.</p>
<p>I helped the official campaign with the setup on Google App Enginer, but
that is another story.</p>
<p>Before running the project in production, we needed to import a lot of
data about the polling stations and the voters, like the Governorate it
belonged to, the city, the number of voters per every station, the
police station it belongs to, address, etc.</p>
<p>This data was only available in an excel sheet so I had to find a quick
programatical way to import it.</p>
<p>For the sake of simplicity, lets assume the data in the excel sheet was
formatted like this :</p>
<div class="highlight"><pre>+-------------------+------------+------------------------+
| Polling Station   | City       | Total Number of Voters |
+-------------------+------------+------------------------+
| polling_station_1 | Cairo      | 7734                   |
+-------------------+------------+------------------------+
| polling_station_2 | Giza       | 13332                  |
+-------------------+------------+------------------------+
| polling_station_3 | Alexandria | 10901                  |
+-------------------+------------+------------------------+
</pre></div>


<p>As in most spreadsheets, the first row is the header row that describes
the data, and the actual data is in the rows to follow.</p>
<p>I did a quick search and found several libraries that deal with excel in
Python,</p>
<p>there is even a website dedicated to listing them
<a href="http://www.python-excel.org">http://www.python-excel.org</a>.</p>
<p>I chose to go with <a href="http://pypi.python.org/pypi/xlrd">XLRD</a>, and you can find it in <a href="http://www.lexicon.net/sjmachin/xlrd.htm">PyPi</a> as well.</p>
<p>We need to install it first by running this command :</p>
<div class="highlight"><pre><span class="nv">$ </span>pip install xlrd
</pre></div>


<p>or</p>
<div class="highlight"><pre><span class="nv">$ </span>easy_install xlrd
</pre></div>


<p>Let's start coding.</p>
<p>XLRD calls the whole excel document a "Workbook", to open it we can do
the following in an interactive python</p>
<p>shell from the same path as the file:</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">xlrd</span> <span class="kn">import</span> <span class="n">open_workbook</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">book</span> <span class="o">=</span> <span class="n">open_workbook</span><span class="p">(</span><span class="s">&#39;data.xls&#39;</span><span class="p">)</span>
</pre></div>


<p>Now we can manipulate the excel document using this "book" object we
created. Remember the book has all the document.</p>
<p>An excel document can have one or multiple sheets inside it that hold
the data.</p>
<p>The first sheet has an index of 0, the second has an index of 1 and so
on.</p>
<p>To open the first sheet which holds the sample data above we do this :</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">first_sheet</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">sheet_by_index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>


<p>Now we are ready to manipulate the sheet, get information about it and
extract data from it.</p>
<p>For example to know the number of "effective columns" in the sheet we
can print the <code>ncols</code> attribute of the sheet,</p>
<p>or to know the number of "effective rows", the rows that contain data,
we can use the <code>nrows</code> attribute.</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">first_sheet</span><span class="o">.</span><span class="n">ncols</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">first_sheet</span><span class="o">.</span><span class="n">nrows</span>
<span class="mi">4</span>
</pre></div>


<p>We now know how many rows contain actual data in the first sheet of our
excel document. Time to loop over the rows and extract data.</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">first_sheet</span><span class="o">.</span><span class="n">nrows</span><span class="p">):</span>        
      <span class="n">row</span> <span class="o">=</span> <span class="n">first_sheet</span><span class="o">.</span><span class="n">row_slice</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>        
      <span class="n">station</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>        
      <span class="n">city</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>        
      <span class="n">voters</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>        
      <span class="k">print</span> <span class="s">&quot;Polling Station : {} in {} has {} voter&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">voters</span><span class="p">)</span>
<span class="n">Polling</span> <span class="n">station</span> <span class="n">polling_station_1</span> <span class="ow">in</span> <span class="n">Cairo</span> <span class="n">has</span> <span class="mf">7734.0</span> <span class="n">voters</span>
<span class="n">Polling</span> <span class="n">station</span> <span class="n">polling_station_2</span> <span class="ow">in</span> <span class="n">Giza</span> <span class="n">has</span> <span class="mf">13332.0</span> <span class="n">voters</span>
<span class="n">Polling</span> <span class="n">station</span> <span class="n">polling_station_3</span> <span class="ow">in</span> <span class="n">Alexandria</span> <span class="n">has</span> <span class="mf">10901.0</span> <span class="n">voters</span>
</pre></div>


<p>In the previous snippet of code we started to loop over the rows
skipping the first row <code>range(1, first_sheet.nrows)</code></p>
<p>Then we sliced every row out of the sheet with <code>row_slice()</code> and then
accessed it by column index to extract data from columns <code>row[]</code></p>
<p>and then we accessed the value of the cell by calling the <code>row[].value</code>.</p>
<p>This is a very simple usage of the library, I suggest you read its
documentation, you will find many great stuff :</p>
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">xlrd</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="n">xlrd</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="n">xlrd</span><span class="o">.</span><span class="n">sheet</span><span class="p">)</span>
</pre></div>


<p>Finally check my answer on a question about the issue on
<a href="http://stackoverflow.com/questions/13805274/have-no-idea-with-python-excel-read-data-file/13805734#13805734">StackOverflow</a>.</p>
<p>That's it for now.</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'mos3abof'; // required: replace example with your forum shortname

                    var disqus_identifier = 'reading-data-from-excel-sheets-in-python';
                var disqus_url = 'http://www.mos3abof.com:8000/reading-data-from-excel-sheets-in-python.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="http://twitter.com/mos3abof"><i class="fa fa-twitter-square fa-lg"></i> twitter</a></li>
                <li class="list-group-item"><a href="http://www.linkedin.com/in/mosab"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
                <li class="list-group-item"><a href="http://github.com/mos3abof"><i class="fa fa-github-square fa-lg"></i> github</a></li>
              </ul>
            </li>



            <li class="list-group-item"><a href="http://www.mos3abof.com:8000/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group list-inline tagcloud" id="tags">
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/addon.html">
                            Addon
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/api.html">
                            API
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/caffeine.html">
                            Caffeine
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/career.html">
                            Career
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/code.html">
                            Code
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/dreamhost.html">
                            Dreamhost
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/excel.html">
                            Excel
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/fabric.html">
                            Fabric
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/firefox.html">
                            Firefox
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/gdata.html">
                            GData
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/ide.html">
                            IDE
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/ie.html">
                            IE
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/microsoft.html">
                            Microsoft
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/monitoring.html">
                            monitoring
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/open-source.html">
                            Open Source
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/power.html">
                            Power
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://www.mos3abof.com:8000/tag/python.html">
                            Python
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/raspberry-pi.html">
                            Raspberry Pi
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/security.html">
                            Security
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/security-ubuntu-fingerprint.html">
                            Security Ubuntu Fingerprint
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/sublime.html">
                            Sublime
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/toggl.html">
                            Toggl
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/urllib.html">
                            urllib
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.mos3abof.com:8000/tag/xlrd.html">
                            XLRD
                        </a>
                    </li>
                </ul>
            </li>

    <li class="list-group-item"><h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
            <a href="https://github.com/mos3abof">@mos3abof</a> on GitHub
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Mosab Ahmad
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://www.mos3abof.com:8000/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://www.mos3abof.com:8000/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://www.mos3abof.com:8000/theme/js/respond.min.js"></script>

    <!-- GitHub JS -->
    <script type="text/javascript">
        $(document).ready(function () {
            if (!window.jXHR) {
                var jxhr = document.createElement('script');
                jxhr.type = 'text/javascript';
                jxhr.src = 'http://www.mos3abof.com:8000/theme/js/jXHR.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(jxhr, s);
            }

            github.showRepos({
                user: 'mos3abof',
                count: 5,
                skip_forks: true,
                target: '#gh_repos'
            });
        });
    </script>
    <script src="http://www.mos3abof.com:8000/theme/js/github.js" type="text/javascript"></script>
    <!-- End GitHub JS Code -->
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'mos3abof'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=mos3abof"></script>
</body>
</html>