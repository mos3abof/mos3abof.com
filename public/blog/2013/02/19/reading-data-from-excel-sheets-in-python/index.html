
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Simple Guide to Reading Data from Excel Sheets in Python - Mosab Ahmad</title>
  <meta name="author" content="Mosab Ahmad">

  
  <meta name="description" content="On May 22nd 2012 I was approached by the official campaign of the presidential candidate &#8221;Abolfotoh&#8221;.
They needed help setting up a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.mos3abof.com/blog/2013/02/19/reading-data-from-excel-sheets-in-python/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Mosab Ahmad" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-5860432-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Mosab Ahmad</a></h1>
  
    <h2>Supposedly a geek, DevOps Software Engineer & Free and Open Source Software Enthusiast</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.mos3abof.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about/">About Me</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Simple Guide to Reading Data From Excel Sheets in Python</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-19T13:18:00+02:00" pubdate data-updated="true">Feb 19<span>th</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>On May 22nd 2012 I was approached by the official campaign of the presidential candidate &#8221;<a href="http://www.abolfotoh.net/">Abolfotoh</a>&#8221;.
They needed help setting up a Google App Engine project.
It was originally created by &#8221;<a href="http://www.espace.com.eg">e-space</a>&#8221; -an awesome Egyptian company- and published on <a href="https://code.google.com/p/egypt-election-2012-demo/">Google Code</a>.
I helped them with he setup, but that is another story.</p>

<p>The application was an interactive map that uses Google Maps to plot data about voters and polling stations.
What they wanted further was to create another application to collect data from their official representatives on the ground and use this tool
to feed the Google App Engine application with data.</p>

<p>The first task was to import the polling stations meta data -if we may call it so- like the Governorate it belonged to, the city,
the number of voter, the police station it belongs to, address, etc.
This data was provided to me in an excel sheet so I had to find an automated way to import it.</p>

<p>For the sake of simplicity, lets assume we have an excel sheet that looks like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>+-------------------+------------+------------------------+
</span><span class='line'>| Polling Station   | City       | Total Number of Voters |
</span><span class='line'>+-------------------+------------+------------------------+
</span><span class='line'>| polling_station_1 | Cairo      | 7734                   |
</span><span class='line'>+-------------------+------------+------------------------+
</span><span class='line'>| polling_station_2 | Giza       | 13332                  |
</span><span class='line'>+-------------------+------------+------------------------+
</span><span class='line'>| polling_station_3 | Alexandria | 10901                  |
</span><span class='line'>+-------------------+------------+------------------------+</span></code></pre></td></tr></table></div></figure>


<p>As in most spreadsheets, the first row is the header row that describes the data, and the actual data is in the rows to follow.</p>

<p>I did a quick search and found several libraries that deal with excel in Python,
there is even a website dedicated to listing them  <a href="http://www.python-excel.org">http://www.python-excel.org</a>.
I chose to go with <a href="http://pypi.python.org/pypi/xlrd">XLRD</a>, and you can find it in <a href="http://www.lexicon.net/sjmachin/xlrd.htm">PyPi</a> as well.</p>

<p>We need to install it first by running this command :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pip install xlrd</span></code></pre></td></tr></table></div></figure>


<p>or</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ easy_install xlrd</span></code></pre></td></tr></table></div></figure>


<p>Let&#8217;s start coding.</p>

<p>XLRD calls the whole excel document a &#8220;Workbook&#8221;, to open we can do this in an interactive python shell from the same path as the file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">xlrd</span> <span class="kn">import</span> <span class="n">open_workbook</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">book</span> <span class="o">=</span> <span class="n">open_workbook</span><span class="p">(</span><span class="s">&#39;data.xls&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we can manipulate the excel document using this &#8220;book&#8221; object we created. Remember the book has all the document.
An excel document can  have one or multiple sheets inside it that hold the data.
The first sheet has an index of 0, the second has an index of 1 and so on.</p>

<p>To open the first sheet which holds the sample data above we do this :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">first_sheet</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">sheet_by_index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we are ready to manipulate the sheet, get information about it and extract data from it.
For example to know the number of &#8220;effective columns&#8221; in the sheet we can print the <code>ncols</code> attribute of the sheet,
or to know the number of &#8220;effective rows&#8221;, the rows that contain data, we can use the <code>nrows</code> attribute.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">first_sheet</span><span class="o">.</span><span class="n">ncols</span>
</span><span class='line'><span class="mi">3</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">first_sheet</span><span class="o">.</span><span class="n">nrows</span>
</span><span class='line'><span class="mi">4</span>
</span></code></pre></td></tr></table></div></figure>


<p>We now know how many rows contain actual data in the first sheet of our excel document. Time to loop over the rows and extract data.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">first_sheet</span><span class="o">.</span><span class="n">nrows</span><span class="p">):</span>
</span><span class='line'>        <span class="n">row</span> <span class="o">=</span> <span class="n">first_sheet</span><span class="o">.</span><span class="n">row_slice</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span class='line'>        <span class="n">station</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
</span><span class='line'>        <span class="n">city</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
</span><span class='line'>        <span class="n">voters</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
</span><span class='line'>        <span class="k">print</span> <span class="s">&quot;Polling Station : {} in {} has {} voter&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">station</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">voters</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">Polling</span> <span class="n">station</span> <span class="n">polling_station_1</span> <span class="ow">in</span> <span class="n">Cairo</span> <span class="n">has</span> <span class="mf">7734.0</span> <span class="n">voters</span>
</span><span class='line'><span class="n">Polling</span> <span class="n">station</span> <span class="n">polling_station_2</span> <span class="ow">in</span> <span class="n">Giza</span> <span class="n">has</span> <span class="mf">13332.0</span> <span class="n">voters</span>
</span><span class='line'><span class="n">Polling</span> <span class="n">station</span> <span class="n">polling_station_3</span> <span class="ow">in</span> <span class="n">Alexandria</span> <span class="n">has</span> <span class="mf">10901.0</span> <span class="n">voters</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the previous snippet of code we started to loop over the rows skipping the first row <code>range(1, first_sheet.nrows)</code>
Then we sliced every row out of the sheet with <code>row_slice()</code> and then accessed it by column index to extract data from columns <code>row[]</code>
and then we accessed the value of the cell by calling the <code>row[].value</code>.</p>

<p>This is a very simple usage of the library, I suggest you read its documentation, you will find many great stuff :</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">xlrd</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="n">xlrd</span><span class="p">)</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="n">xlrd</span><span class="o">.</span><span class="n">sheet</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally check my answer on a question about the issue on <a href="http://stackoverflow.com/questions/13805274/have-no-idea-with-python-excel-read-data-file/13805734#13805734">StackOverflow</a>.</p>

<p>That&#8217;s it for now.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Mosab Ahmad</span></span>

      








  


<time datetime="2013-02-19T13:18:00+02:00" pubdate data-updated="true">Feb 19<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/excel/'>Excel</a>, <a class='category' href='/blog/categories/python-/'>Python,</a>, <a class='category' href='/blog/categories/xlrd-/'>XLRD,</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.mos3abof.com/blog/2013/02/19/reading-data-from-excel-sheets-in-python/" data-via="mos3abof" data-counturl="http://www.mos3abof.com/blog/2013/02/19/reading-data-from-excel-sheets-in-python/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/02/11/monitoring-a-website-using-python/" title="Previous Post: Poor man's guide for Monitoring a website using Python">&laquo; Poor man's guide for Monitoring a website using Python</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
<a href="http://www.flickr.com/photos/mos3ab/4308510641/" title="Mosab The Great by mos3ab, on Flickr">
<img src="http://farm5.staticflickr.com/4018/4308510641_81e137b4c9_n.jpg" width="280" height="165" alt="Mosab The Great" /></a>
<br />
I am a proud Muslim Egyptian, a caffeine junkie, a food lover, supposedly a geek, 
a software engineer, an open source & free software believer and -finally- 
an entrepreneur in the make. Currently living in Cairo, Egypt.
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/02/19/reading-data-from-excel-sheets-in-python/">Simple Guide to Reading Data from Excel Sheets in Python</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/11/monitoring-a-website-using-python/">Poor man's guide for Monitoring a website using Python</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/29/installing-gdata-python-client-on-dreamhost/">Installing Gdata Python Client on Dreamhost</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/mos3abof">@mos3abof</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mos3abof',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("mos3abof", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/mos3abof" class="twitter-follow-button" data-show-count="false">Follow @mos3abof</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/103419053954297467507?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
	Copyright &copy; 2007-2013 - <a href="/">Mosab Ahmad</a> | 
	This site is built with
	<a href="http://octopress.org" target="_blank">Octopress</a>
	and is hosted on 
	<a href="https://cloud.google.com/products/" target="_blank">Google App Engine</a>. 
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'mos3abof';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.mos3abof.com/blog/2013/02/19/reading-data-from-excel-sheets-in-python/';
        var disqus_url = 'http://www.mos3abof.com/blog/2013/02/19/reading-data-from-excel-sheets-in-python/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
